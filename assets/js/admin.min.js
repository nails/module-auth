!function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){},,,function(e,t,r){"use strict";r.r(t);r(0);var i=class{constructor(){$(".group-accounts.edit").length&&this.initEmailManagement()}initEmailManagement(){$("#add-email-form a.submit").on("click",()=>(this.addEmail(),!1)),$("#add-email-form input[name=email]").on("keydown",e=>13!==e.which||(this.addEmail(),!1)),$("tr.existing-email td.actions a").on("click",e=>{let t=$(e.currentTarget),r=t.closest("tr").data("email");switch(t.data("action")){case"delete":this.deleteEmail(r);break;case"verify":this.verifyEmail(r);break;case"make-primary":this.makePrimaryEmail(r);break;default:console.log("no action")}return!1})}addEmail(){let e=$("#add-email-form input[name=email]").val(),t=$("#add-email-form input[name=isPrimary]").is(":checked")?1:0,r=$("#add-email-form input[name=isVerified]").is(":checked")?1:0;$("#email-form input[name=action]").val("add"),$("#email-form input[name=email]").val(e),$("#email-form input[name=isPrimary]").val(t),$("#email-form input[name=isVerified]").val(r),$("#email-form").submit()}deleteEmail(e){let t=$("<div>").text('Are you sure you want to delete "'+e+'"?').dialog({title:"Are you sure?",resizable:!1,draggable:!1,modal:!0,buttons:{OK:function(){$("#email-form input[name=action]").val("delete"),$("#email-form input[name=email]").val(e),$("#email-form").submit()},Cancel:function(){t.dialog("close")}}})}verifyEmail(e){$("#email-form input[name=action]").val("verify"),$("#email-form input[name=email]").val(e),$("#email-form").submit()}makePrimaryEmail(e){$("#email-form input[name=action]").val("makePrimary"),$("#email-form input[name=email]").val(e),$("#email-form").submit()}};var a=class{constructor(){$(".group-accounts.merge").length&&$("#merge-form").on("submit",()=>this.validate())}validate(){let e,t,r=!1,i=[],a=parseInt($("#user-id").val(),10),o=$("#merge-ids").val().split(","),s=[];for(e=0;e<o.length;e++)o[e]&&s.push(parseInt(o[e],10));for(isNaN(a)&&(r=!0,i.push("You must specify the user to keep.")),0===s.length&&(r=!0,i.push("You must specify at least one user to merge.")),e=0;e<s.length;e++)if(s[e]===a){r=!0,i.push("The user to merge into cannot be listed as a merge user.");break}for(e=0;e<s.length;e++)if(s[e]===window.NAILS.USER.ID){r=!0,i.push("You cannot specify yourself as a merge user.");break}if(!1===r)return!0;t="<p>The following errors occurred:</p>",t+="<ul>";for(let e in i)i.hasOwnProperty(e)&&(t+="<li>&rsaquo; "+i[e]+"</li>");t+="</ul>";let n=$("<div>").html(t).dialog({title:"An error occurred",resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{OK:function(){n.dialog("close")}}}).show();return!1}};var o=class{constructor(){this.searchTimeout=null,this.searchDelay=150,$(".group-accounts.groups.edit").length&&(this.toggleSuperuser(),this.togglePermissions(),this.permissionSearch())}toggleSuperuser(){$(".field.boolean .toggle").on("toggle",(function(e,t){t?$("#adminPermissions").hide():$("#adminPermissions").show()}))}togglePermissions(){$(".permission-group tbody td.permission").on("click",(e,t)=>{$(t).closest("tr").find("input[type=checkbox]").click()}),$(".permission-group tbody td.enabled input").on("change",e=>{let t=$(e.currentTarget),r=t.closest("td");t.is(":checked")?(r.removeClass("error"),r.addClass("success")):(r.addClass("error"),r.removeClass("success"))}),$(".permission-group .toggleAll").on("click",e=>{let t=$(e.currentTarget),r=t.closest("table").find("tbody td.enabled input"),i=t.is(":checked");r.each((e,t)=>{let r=$(t);r.prop("checked",i);let a=r.closest("td");r.is(":checked")?(a.removeClass("error"),a.addClass("success")):(a.addClass("error"),a.removeClass("success"))})})}permissionSearch(){$("#permissionSearch input").on("keyup",e=>{let t=$(e.currentTarget),r=$.trim(t.val());clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{console.log("search"),this.doPermissionSearch(r)},this.searchDelay)})}doPermissionSearch(e){let t,r,i;if(""===e)return $(".permission-group").show(),void $(".permission-group tbody tr").show();t=new RegExp($.trim(e),"i"),$(".permission-group td.permission").each((e,a)=>{let o=$(a);r=$.trim(o.text()),(i=t.test(r))?o.closest("tr").show():o.closest("tr").hide()}),$(".permission-group legend").each((e,a)=>{let o=$(a);r=$.trim(o.text()),(i=t.test(r))&&o.parent().find("tbody tr").show()}),$(".permission-group").show(),$(".permission-group").each((e,t)=>{let r=$(t);r.find("td.permission:visible").length>0?r.show():r.hide()})}};var s=class{constructor(){let e=[{class:"user-search",placeholder:"Search for a user",minimumInputLength:3,apiUrl:window.SITE_URL+"api/auth/user",format:function(e){return"#"+e.id+" - "+e.first_name+" "+e.last_name+" ("+e.email+")"}}];for(let t in e)e.hasOwnProperty(t)&&this.setupSearcher(e[t])}setupSearcher(e){$("input."+e.class).each((t,r)=>{let i=$(r),a=i.data("multiple")||!1;i.select2({placeholder:e.placeholder,minimumInputLength:e.minimumInputLength,multiple:a,ajax:{url:e.apiUrl+"/search",dataType:"json",quietMillis:250,data:function(e){return{keywords:e}},results:function(t){let r,i={results:[]};for(let a in t.data)t.data.hasOwnProperty(a)&&(r="function"==typeof e.format?e.format(t.data[a]):t.data[a].label,i.results.push({id:t.data[a].id,text:r}));return i},cache:!0},initSelection:function(t,r){let i=$(t).val();""!==i&&(a?$.ajax({url:e.apiUrl+"/id?ids="+i,dataType:"json"}).done((function(t){let i=[],a="";for(let r=0;r<t.data.length;r++)a="function"==typeof e.format?e.format(t.data[r]):t.data[r].label,i.push({id:t.data[r].id,text:a});r(i)})):$.ajax({url:e.apiUrl+"/id?id="+i,dataType:"json"}).done((function(t){let i;i="function"==typeof e.format?e.format(t.data):t.data.label,r({id:t.data.id,text:i})})))}})})}};new class{constructor(){$(".group-accounts.create").length&&$("select[name=group_id]").on("change",(function(){$("#user-group-descriptions li").hide(),$("#user-group-pwrules li").hide(),$("#user-group-"+$(this).val()).show(),$("#user-group-pw-"+$(this).val()).show()}))}},new i,new a,new o,new s}]);