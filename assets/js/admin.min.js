!function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){},,,function(e,t,r){"use strict";r.r(t);r(0);var i=class{constructor(){$(".group-accounts.edit").length&&this.initEmailManagement()}initEmailManagement(){$("#addEmailForm a.submit").Event("click",()=>(this.addEmail(),!1)),$("#addEmailForm input[name=email]").Event("keydown",e=>13!==e.which||(this.addEmail(),!1)),$("tr.existingEmail td.actions a").Event("click",(e,t)=>{let r=$(t),i=r.closest("tr").data("email");switch(r.data("action")){case"delete":this.deleteEmail(i);break;case"verify":this.verifyEmail(i);break;case"makePrimary":this.makePrimaryEmail(i)}return!1})}addEmail(){let e=$("#addEmailForm input[name=email]").val(),t=$("#addEmailForm input[name=isPrimary]").is(":checked")?1:0,r=$("#addEmailForm input[name=isVerified]").is(":checked")?1:0;$("#emailForm input[name=action]").val("add"),$("#emailForm input[name=email]").val(e),$("#emailForm input[name=isPrimary]").val(t),$("#emailForm input[name=isVerified]").val(r),$("#emailForm").submit()}deleteEmail(e){let t=$("<div>").text('Are you sure you want to delete "'+e+'"?').dialog({title:"Are you sure?",resizable:!1,draggable:!1,modal:!0,buttons:{OK:function(){$("#emailForm input[name=action]").val("delete"),$("#emailForm input[name=email]").val(e),$("#emailForm").submit()},Cancel:function(){t.dialog("close")}}})}verifyEmail(e){$("#emailForm input[name=action]").val("verify"),$("#emailForm input[name=email]").val(e),$("#emailForm").submit()}makePrimaryEmail(e){$("#emailForm input[name=action]").val("makePrimary"),$("#emailForm input[name=email]").val(e),$("#emailForm").submit()}};var a=class{constructor(){$(".group-accounts.merge").length&&($("#userId").select2({placeholder:"Search for a user",minimumInputLength:1,ajax:{url:window.SITE_URL+"api/admin/users/search",dataType:"json",quietMillis:250,data:function(e){return{term:e}},results:function(e){let t={results:[]},r="",i="";for(let a in e.users)e.users.hasOwnProperty(a)&&(i="#"+(r=e.users[a].id)+" - "+e.users[a].first_name+" "+e.users[a].last_name,t.results.push({text:i,id:r}));return t},cache:!0}}),$("#mergeIds").select2({placeholder:"Search for users",minimumInputLength:1,multiple:!0,ajax:{url:window.SITE_URL+"api/admin/users/search",dataType:"json",quietMillis:250,data:function(e){return{term:e}},results:function(e){let t={results:[]},r="",i="";for(let a in e.users)e.users.hasOwnProperty(a)&&(i="#"+(r=e.users[a].id)+" - "+e.users[a].first_name+" "+e.users[a].last_name,t.results.push({text:i,id:r}));return t},cache:!0}}),$("#theForm").on("submit",()=>this.validate()))}validate(){let e,t,r=!1,i=[],a=parseInt($("#userId").val(),10),s=$("#mergeIds").val().split(","),n=[];for(e=0;e<s.length;e++)s[e]&&n.push(parseInt(s[e],10));for(isNaN(a)&&(r=!0,i.push("You must specify the user to keep.")),0===n.length&&(r=!0,i.push("You must specify at least one user to merge.")),e=0;e<n.length;e++)if(n[e]===a){r=!0,i.push("The user to merge into cannot be listed as a merge user.");break}for(e=0;e<n.length;e++)if(n[e]===window.NAILS.USER.ID){r=!0,i.push("You cannot specify yourself as a merge user.");break}if(!1===r)return!0;t="<p>The following errors occurred:</p>",t+="<ul>";for(let e in i)i.hasOwnProperty(e)&&(t+="<li>&rsaquo; "+i[e]+"</li>");t+="</ul>";let o=$("<div>").html(t).dialog({title:"An error occurred",resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{OK:function(){o.dialog("close")}}}).show();return!1}};var s=class{constructor(){this.searchTimeout=null,this.searchDelay=150,$(".group-accounts.groups.edit").length&&(this.toggleSuperuser(),this.togglePermissions(),this.permissionSearch())}toggleSuperuser(){$(".field.boolean .toggle").Event("toggle",function(e,t){t?$("#adminPermissions").hide():$("#adminPermissions").show()})}togglePermissions(){$(".permission-group tbody td.permission").Event("click",(e,t)=>{$(t).closest("tr").find("input[type=checkbox]").click()}),$(".permission-group tbody td.enabled input").Event("change",(e,t)=>{let r=$(t),i=r.closest("td");r.is(":checked")?(i.removeClass("error"),i.addClass("success")):(i.addClass("error"),i.removeClass("success"))}),$(".permission-group .toggleAll").Event("click",(e,t)=>{let r=$(t),i=r.closest("table").find("tbody td.enabled input"),a=r.is(":checked");i.each((e,t)=>{let r=$(t);r.prop("checked",a);let i=r.closest("td");r.is(":checked")?(i.removeClass("error"),i.addClass("success")):(i.addClass("error"),i.removeClass("success"))})})}permissionSearch(){$("#permissionSearch input").Event("keyup",(e,t)=>{let r=$(t),i=$.trim(r.val());clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){this.doPermissionSearch(i)},this.searchDelay)})}doPermissionSearch(e){let t,r,i;if(""===e)return $(".permission-group").show(),void $(".permission-group tbody tr").show();t=new RegExp($.trim(e),"i"),$(".permission-group td.permission").each((e,a)=>{let s=$(a);r=$.trim(s.text()),(i=t.test(r))?s.closest("tr").show():s.closest("tr").hide()}),$(".permission-group legend").each((e,a)=>{let s=$(a);r=$.trim(s.text()),(i=t.test(r))&&s.parent().find("tbody tr").show()}),$(".permission-group").show(),$(".permission-group").each((e,t)=>{let r=$(t);r.find("td.permission:visible").length>0?r.show():r.hide()})}};var n=class{constructor(){let e=[{class:"user-search",placeholder:"Search for a user",minimumInputLength:3,apiUrl:window.SITE_URL+"api/auth/user",format:function(e){return"#"+e.id+" - "+e.first_name+" "+e.last_name+" ("+e.email+")"}}];for(let t in e)e.hasOwnProperty(t)&&this.setupSearcher(e[t])}setupSearcher(e){$("input."+e.class).each((t,r)=>{let i=$(r),a=i.data("multiple")||!1;i.select2({placeholder:e.placeholder,minimumInputLength:e.minimumInputLength,multiple:a,ajax:{url:e.apiUrl+"/search",dataType:"json",quietMillis:250,data:function(e){return{keywords:e}},results:function(t){let r,i={results:[]};for(let a in t.data)t.data.hasOwnProperty(a)&&(r="function"==typeof e.format?e.format(t.data[a]):t.data[a].label,i.results.push({id:t.data[a].id,text:r}));return i},cache:!0},initSelection:function(t,r){let i=$(t).val();""!==i&&(a?$.ajax({url:e.apiUrl+"/id?ids="+i,dataType:"json"}).done(function(t){let i=[],a="";for(let r=0;r<t.data.length;r++)a="function"==typeof e.format?e.format(t.data[r]):t.data[r].label,i.push({id:t.data[r].id,text:a});r(i)}):$.ajax({url:e.apiUrl+"/id?id="+i,dataType:"json"}).done(function(t){let i;i="function"==typeof e.format?e.format(t.data):t.data.label,r({id:t.data.id,text:i})}))}})})}};new class{constructor(){$(".group-accounts.create").length&&$("select[name=group_id]").Event("change",function(){$("#user-group-descriptions li").hide(),$("#user-group-pwrules li").hide(),$("#user-group-"+$(this).val()).show(),$("#user-group-pw-"+$(this).val()).show()})}},new i,new a,new s,new n}]);